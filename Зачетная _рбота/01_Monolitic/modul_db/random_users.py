# -*- coding: utf-8 -*-

import random
import string

class User:
    @staticmethod
    def random_first_name():
        names = [
                "Авдей", "Авксентий", "Агапит", "Агафон", "Акакий", "Акиндин", "Александр", "Алексей", "Альберт",
                "Анатолий", "Андрей", "Аникий", "Аникита", "Антон", "Антонин", "Анфим", "Аристарх", "Аркадий", "Арсений",
                "Артём", "Артемий", "Артур", "Архипп", "Афанасий",
                "Богдан", "Борис",
                "Вавила", "Вадим", "Валентин", "Валерий", "Валерьян", "Варлам", "Варсонофий", "Варфоломей", "Василий",
                "Венедикт", "Вениамин", "Викентий", "Виктор", "Виссарион", "Виталий", "Владимир", "Владислав",
                "Владлен", "Влас", "Всеволод", "Вячеслав",
                "Гавриил", "Галактион", "Геласий", "Геннадий", "Георгий", "Герасим", "Герман", "Германн", "Глеб",
                "Гордей", "Григорий",
                "Давид", "Данакт", "Даниил", "Демид", "Демьян", "Денис", "Дмитрий", "Донат",
                "Евгений", "Евграф", "Евдоким", "Евсей", "Евстафий", "Егор", "Емельян", "Еремей", "Ермолай", "Ерофей",
                "Ефим", "Ефрем",
                "Ждан",
                "Зиновий",
                "Иакинф", "Иван", "Игнатий", "Игорь", "Изот", "Илья", "Иннокентий", "Ираклий", "Ириней", "Исаак",
                "Исидор", "Иуда", "Иулиан",
                "Капитон", "Ким", "Кир", "Кирилл", "Климент", "Кондрат", "Конон", "Константин", "Корнилий", "Кронид",
                "Кузьма", "Куприян",
                "Лаврентий", "Лев", "Леонид", "Леонтий", "Логгин", "Лука", "Лукий", "Лукьян",
                "Магистриан", "Макар", "Максим", "Мамонт", "Марк", "Мартын", "Матвей", "Мелентий", "Мина", "Мирослав",
                "Митрофан", "Михаил", "Мстислав",
                "Назар", "Наум", "Нестор", "Никандр", "Никанор", "Никита", "Никифор", "Никодим", "Николай", "Никон",
                "Олег", "Онисим", "Онуфрий",
                "Павел", "Паисий", "Панкратий", "Пантелеймон", "Парфений", "Пафнутий", "Пахомий", "Пётр", "Платон",
                "Поликарп", "Порфирий", "Потап", "Пров", "Прокопий", "Протасий", "Прохор",
                "Разумник", "Родион", "Роман", "Ростислав", "Руслан",
                "Савва", "Савелий", "Самуил", "Святополк", "Святослав", "Севастьян", "Семён", "Серафим", "Сергей",
                "Сила", "Сильвестр", "Созон", "Софрон", "Спиридон", "Станислав", "Степан",
                "Тарас", "Тимофей", "Тимур", "Тит", "Тихон", "Трифон", "Трофим",
                "Урбан",
                "Фаддей", "Фёдор", "Федосей", "Федот", "Феликс", "Феоктист", "Филат", "Филимон", "Филипп", "Фирс",
                "Фока", "Фома", "Фотий", "Фрол",
                "Харитон", "Хрисанф", "Христофор",
                "Эдуард", "Эраст",
                "Юлиан", "Юрий", "Юстин",
                "Яков", "Якун", "Ярослав"]
        return random.choice(names)
    
    @staticmethod
    def random_last_name():
        last_names = [
                "Абрамов", "Абрамович", "Аксёнов", "Александров", "Алексеев", 
                "Андреев", "Анисимов", "Антонов", "Архипов", "Афанасьев", 
                "Баранов", "Белов", "Белозёров", "Белоусов", "Беляев", "Березин", 
                "Беспалов", "Бирюков", "Блинов", "Богданов", "Борисов", "Брагин", 
                "Буров", "Быков", 
                "Васильев", "Виноградов", "Власов", "Волков", "Воробьёв", 
                "Воронов", "Воронцов", 
                "Гаврилов", "Галкин", "Гвоздев", "Герасимов", "Голубев", 
                "Гончаров", "Горбачёв", "Горбунов", "Гордеев", "Григорьев", 
                "Громов", "Гусев", "Гущин", 
                "Давыдов", "Данилов", "Дементьев", "Демидов", "Демин", "Денисов", 
                "Дмитриев", "Доронин", "Дорофеев", "Дьячков", 
                "Егоров", "Елисеев", "Емельянов", "Ермаков", "Ершов", "Ефимов", 
                "Жданов", "Жуков", "Журавлёв", 
                "Зайцев", "Захаров", "Зимин", "Зиновьев", "Зуев", 
                "Иванов", "Игнатов", "Ильин", "Исаев", 
                "Кабанов", "Казаков", "Калинин", "Калмыков", "Капустин", "Карпов", 
                "Кириллов", "Киселёв", "Князев", "Ковалёв", "Козлов", "Колесников",
                "Колобов", "Комаров", "Кондратьев", "Крылов", "Крюков", "Кудрявцев", 
                "Кудряшов", "Кузнецов", "Кузьмин", "Куликов", 
                "Лазарев", "Лапин", "Лебедев", "Левин", "Лихачёв", "Лобанов", 
                "Логинов", "Лукин", "Лыткин", "Львов", 
                "Макаров", "Максимов", "Мамонтов", "Марков", "Мартынов", "Маслов", 
                "Матвеев", "Медведев", "Мельников", "Меркушев", "Миронов", "Михеев", 
                "Моисеев", "Молчанов", "Морозов", "Мухин", "Мышкин", "Мясников", 
                "Назаров", "Наумов", "Некрасов", "Никитин", "Никифоров", "Николаев", 
                "Новиков", "Носков", 
                "Овчинников", "Одинцов", "Орлов", "Осипов", 
                "Павлов", "Панов", "Пантелеев", "Петров", "Петухов", "Поляков", 
                "Пономарёв", "Попов", "Потапов", "Прохоров", 
                "Родионов", "Рожков", "Романов", "Русаков", "Рыбаков", "Рябов", 
                "Савельев", "Савин", "Сазонов", "Самойлов", "Самсонов", "Селезнёв", 
                "Селиверстов", "Семёнов", "Сергеев", "Сидоров", "Силин", "Симонов", 
                "Ситников", "Скворцов", "Смирнов", "Соболев", "Соколов", "Соловьёв", 
                "Сорокин", "Степанов", "Стрелков", "Субботин", "Суворов", "Суханов", 
                "Сысоев", 
                "Тарасов", "Терентьев", "Тетерин", "Тимофеев", "Титов", "Тихомиров", 
                "Тихонов", "Токарев", "Третьяков", "Трофимов", "Туров", 
                "Уваров", "Устинов", 
                "Фадеев", "Фёдоров", "Филиппов", "Фокин", "Фомин", "Фомичёв", 
                "Фролов", 
                "Харитонов", "Хохлов", 
                "Цветков", "Чернов", "Чернышёв", "Черняев", "Чехов", 
                "Шаров", "Шестаков", "Шилов", "Ширяев", "Шубин", 
                "Щербаков", 
                "Юдин", 
                "Яковлев", 
                "Якушев"]
        return random.choice(last_names)
    
    @staticmethod
    def transliterate_russian_to_latin(text):
    
        # Словарь замен (русская буква - латинский аналог)
        translit_dict = {
            'а': 'a', 'б': 'b', 'в': 'v', 'г': 'g', 'д': 'd', 'е': 'e', 'ё': 'yo',
            'ж': 'zh', 'з': 'z', 'и': 'i', 'й': 'y', 'к': 'k', 'л': 'l', 'м': 'm',
            'н': 'n', 'о': 'o', 'п': 'p', 'р': 'r', 'с': 's', 'т': 't', 'у': 'u',
            'ф': 'f', 'х': 'kh', 'ц': 'ts', 'ч': 'ch', 'ш': 'sh', 'щ': 'shch',
            'ъ': '', 'ы': 'y', 'ь': '', 'э': 'e', 'ю': 'yu', 'я': 'ya',
            'А': 'A', 'Б': 'B', 'В': 'V', 'Г': 'G', 'Д': 'D', 'Е': 'E', 'Ё': 'Yo',
            'Ж': 'Zh', 'З': 'Z', 'И': 'I', 'Й': 'Y', 'К': 'K', 'Л': 'L', 'М': 'M',
            'Н': 'N', 'О': 'O', 'П': 'P', 'Р': 'R', 'С': 'S', 'Т': 'T', 'У': 'U',
            'Ф': 'F', 'Х': 'Kh', 'Ц': 'Ts', 'Ч': 'Ch', 'Ш': 'Sh', 'Щ': 'Shch',
            'Ъ': '', 'Ы': 'Y', 'Ь': '', 'Э': 'E', 'Ю': 'Yu', 'Я': 'Ya'
        }
        
        result = []
        for char in text:
            # Если символ есть в словаре, заменяем его
            if char in translit_dict:
                result.append(translit_dict[char])
            # Иначе оставляем как есть (для цифр, пунктуации, латиницы)
            # else:
            #     result.append(char)
            
            # Иначе заменяем на подчеркивание
            else:
                result.append('_')
        return ''.join(result)
    
    @staticmethod
    def generate_password(length=12):
        chars = string.ascii_letters + string.digits + "!@#$%^&*"
        return ''.join(random.choice(chars) for _ in range(length))
    
    def __init__(self, user_id = 0, existing_usernames = None):
        self.user_id = user_id
        self.first_name = self.random_first_name()
        self.last_name = self.random_last_name()
        # Генерируем пароль
        self.password = self.generate_password(5)
        
        # Делаем username в нижнем регистре
        base_username = self.transliterate_russian_to_latin(self.last_name).lower()
        
        # Если не передан список существующих имен, создаем пустой
        if existing_usernames is None:
            existing_usernames = []
        
        # Делаем username уникальным
        self.user_name = self.make_unique_username(base_username, existing_usernames)
        
    def make_unique_username(self, base_username, existing_usernames):
        # Если username уже занят, добавляем суффикс (1, 2, 3...)
        if base_username not in existing_usernames:
            return base_username
        else:
            suffix = 1
            new_username = f"{base_username}{suffix}"
            while new_username in existing_usernames:
                suffix += 1
                new_username = f"{base_username}{suffix}"
            return new_username
        
    def print_user(self):
        print(str(self.user_id) + " " + self.first_name + " " + self.last_name + " Имя пользователя: " + self.user_name + " Пароль: " + self.password)

def users_list(quantity_users = 5):
    # Создаем список пользователей с уникальными usernames
    users = []
    existing_usernames = []  # Храним уже использованные имена
    
    for i in range(1, quantity_users + 1):  # Создаем 5 пользователей
        user = User(i, existing_usernames)
        users.append(user)
        existing_usernames.append(user.user_name)  # Добавляем новое имя в список занятых
    
    # Преобразуем в список кортежей
    users_tuples = [
        (user.user_id, user.first_name, user.last_name, user.user_name, user.password)
        for user in users
    ]
    
    return users_tuples
    
if __name__ == "__main__":
    
    import tabulate
    
    # создание одного пользователя
    new_user = User(1)   
    new_user.print_user()
    
    # Создаем список пользователей
    users = users_list()
    print(tabulate.tabulate(users))
    