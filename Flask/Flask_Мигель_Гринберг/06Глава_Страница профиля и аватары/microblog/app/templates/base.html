<!doctype html>
<html>
  <head>
    <!--
    Условные операторы
    Если функция view забудет передать значение для переменной-заполнителя title, 
    то вместо отображения пустого заголовка шаблон предоставит заголовок по умолчанию.
    -->
    <!-- Блок управления заголовком страницы -->
    {% if title %}
      <!-- Если переменная 'title' передана в шаблон - используем её -->
      <title>{{ title }} - Микроблог</title>
    {% else %}
      <!-- Если 'title' не передана - используем заголовок по умолчанию -->
      <title>Микроблог</title>
    {% endif %}
  </head>
  <body>
    <div>
        Микроблог меню: 
        <!-- url_for() генерирует URL-адреса, используя свое внутреннее отображение URL-адресов для просмотра функций
        Например, выражение url_for('login') возвращает /login и url_for('index') возвращает /index
        Без url_for(): <a href="/login">Логин</a> (негибко)-->
        <a href="{{ url_for('index') }}">Домой</a> <!-- Ссылка на главную страницу - отображается всегда для всех пользователей -->
        {% if current_user.is_anonymous %}
        <!-- Этот блок показывается только НЕаутентифицированным пользователям -->
        <!-- current_user.is_anonymous возвращает True для гостей (тех, кто не вошел в систему) -->
        <a href="{{ url_for('login') }}">Логин</a> <!-- Ссылка на страницу входа -->
        {% else %}
        <!-- Этот блок показывается только АУТЕНТИФИЦИРОВАННЫМ пользователям -->
        <!-- Т.е. тем, кто успешно вошел в систему -->
        
        <!-- 'user' - имя функции 
        username - параметр для маршрута 
        current_user - автоматическая переменная Flask-Login
        .username - берет имя текущего вошедшего пользователя
        Для пользователя "ivan": сгенерируется /user/ivan -->
        <a href="{{ url_for('user', username=current_user.username) }}">Профиль</a>
        <a href="{{ url_for('logout') }}">Выйти</a>
        {% endif %}
    </div>

    <!-- Горизонтальная разделительная линия -->
    <hr>

    <!-- Блок для отображения flash-сообщений -->
    {% with messages = get_flashed_messages() %} <!-- get_flashed_messages() получает все сообщения, установленные через flash() в Flask -->
      {% if messages %}
        <ul>
          {% for message in messages %}
            <!-- Вывод каждого сообщения -->
            <li>{{ message }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}
    
    <!-- Блок для основного содержимого страницы из дочерних шаблонов -->
    {% block content %}{% endblock %}

  </body>
  <!-- -->
</html>